<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">

<meta name="ICBM" content="19.0760, 72.8777">
<meta name="geo.position" content="19.0760;72.8777">
<meta name="geo.region" content="IN-MH">
<meta name="geo.placename" content="Mumbai">
<title>æ„å»ºæœ€å° Linux ç³»ç»Ÿ | xym-ee</title>


        <link rel="stylesheet" href="/css/tailwind.min.4a783adb4da105fabad23a262263bcc9d9fade8ada248161a9f40b5ceefb5659.css" type="text/css" integrity="sha256-Sng6202hBfq60jomImO8ydn63oraJIFhqfQLXO77Vlk=" crossorigin="anonymous">

</head>

<body class="bg-gradient-to-r from-slate-900 to-slate-800 font-mono text-white">
  <div class="container mx-auto flex flex-col px-4 xl:w-8/12 sm:max-w-full">
    
  

  <header class="flex flex-row py-4" >

  



  <nav
    class="flex flex-row items-center w-full justify-between">


  
  
    <div class="flex flex-col gap-1">
      <a href="https://xym.work/" class="text-4xl font-bold hover:text-sky-400 whitespace-nowrap">xym-ee</a>
      <p>______________</p>
    </div>
  

  <div class="dropdown-menu flex flex-row absolute max-lg:w-full max-lg:items-center max-lg:justify-center max-lg:-top-full lg:static max-lg:bg-slate-900 max-lg:h-[calc(100dvh)] max-lg:left-0">
    <ul class="flex flex-col lg:flex-row gap-2">
      
  <li class="font-bold border border-sky-400 px-3 py-2 hover:bg-sky-400 focus:text-sky-400 text-center">
    <a href="/about.html">About</a>
  </li>

  <li class="font-bold border border-sky-400 px-3 py-2 hover:bg-sky-400 focus:text-sky-400 text-center">
    <a href="/blog">Blog</a>
  </li>

  <li class="font-bold border border-sky-400 px-3 py-2 hover:bg-sky-400 focus:text-sky-400 text-center">
    <a href="/notebook.html">Notebook</a>
  </li>

    </ul>
  </div>
  <div class="open-dropdown-button lg:hidden">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="32" height="32" fill="white">
      <path
        d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z" />
    </svg>
  </div>
  <div class="close-dropdown-button hidden z-50">
    <svg xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 384 512" width="32" height="32" fill="white">
      <path
        d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
    </svg>
  </div>
</nav>

</header>

  
  <div class="flex flex-col pt-8 gap-10">
    
    <div class="flex flex-col w-full gap-4">
      <h2 class="text-3xl max-sm:text-2xl font-bold">æ„å»ºæœ€å° Linux ç³»ç»Ÿ</h2>
      
      <div class="flex flex-row flex-wrap max-md:gap-4 gap-10">
        <p>ğŸ“… Monday, Jul 17, 2023</p>
        <p>â° 00:00:00</p>
        
          <p>ğŸ”„ Monday, Jul 17, 2023 00:00:00</p>
        
        <p>ğŸ“– Reading time: 1 min</p>
      </div>
      
      <div class="flex flex-row gap-2 flex-nowrap">
        <div class="py-1">ğŸ“</div>
<div class="flex flex-wrap gap-2">
  
</div>
      </div>
      
      <div class="flex flex-row gap-2 flex-nowrap">
        <p class="py-1">ğŸ·ï¸</p>
<div class="flex flex-wrap gap-2">
  
</div>
      </div>
      <hr />
      <div class="flex flex-col gap-10">
        <div class="prose prose-invert max-w-full">
          <ul>
<li><a href="https://www.bilibili.com/video/BV1gg4y1T71C">Linux ä¸–ç•Œä¸­çš„åº”ç”¨ç¨‹åº (ä»é›¶å¼€å§‹æ„å»º â€œæœ€å°â€ Linux) [å—äº¬å¤§å­¦2023æ“ä½œç³»ç»Ÿ-P16] (è’‹ç‚å²©)</a></li>
<li><a href="http://jyywiki.cn/OS/2023/build/lect16.ipynb">16. Linux æ“ä½œç³»ç»Ÿ</a></li>
</ul>
<p>ä¸ºäº†åŠªåŠ›çš„ç†è§£æ“ä½œç³»ç»Ÿï¼Œå­¦ä¹ è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªæƒ³æ³•ï¼šèƒ½ä¸èƒ½æ§åˆ¶ç”µè„‘å¯åŠ¨ååŠ è½½çš„ç¬¬ä¸€ä¸ªç¨‹åºã€‚</p>
<p>äº‹å®ä¸Šï¼Œç”µè„‘å¯åŠ¨åˆ°å‡ºç°æ¡Œé¢ï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶ä¸ç®€å•ã€‚å…ˆä¸è®¨è®º bootloader é˜¶æ®µï¼Œåªè¯´ linux kernelï¼Œå³ä¸€ä¸ªæƒ³æ³•ï¼šæ§åˆ¶ kernel å¯åŠ¨ååŠ è½½çš„ç¬¬ä¸€ä¸ªç¨‹åºã€‚kernel å¯åŠ¨ååŠ è½½çš„ç¨‹åºéƒ½æ”¾åœ¨å­˜å‚¨ä»‹è´¨é‡Œï¼Œå³å­˜å‚¨ä»‹è´¨é‡Œçš„ä¸œè¥¿ä¸éœ€è¦é‚£ä¹ˆå¤šï¼Œç›®å½•è¶³å¤Ÿç®€å•ã€‚</p>
<p>linux ä¸€èˆ¬ä»…æŒ‡ kernelï¼Œæ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰ä¸œè¥¿ä¸ºæ ¹æ–‡ä»¶ç³»ç»Ÿã€‚æ„å»ºæœ€å° Linux ç³»ç»Ÿçš„å®Œæ•´è¯´æ³•ï¼šæ„å»ºæ ¹æ–‡ä»¶ç³»ç»Ÿæœ€å°çš„linuxç³»ç»Ÿã€‚</p>
<p>å¦‚æœæŸ¥çœ‹ pstree ï¼Œå¯ä»¥çœ‹åˆ°è¿›ç¨‹ä¹‹é—´çš„å…³ç³»</p>
<h2 id="qemu-ä¸‹æ¨¡æ‹Ÿ">QEMU ä¸‹æ¨¡æ‹Ÿ</h2>
<p>å¸Œæœ›åœ¨ç»™å®šçš„ linux å†…æ ¸åˆå§‹åŒ–å®Œæˆåï¼Œç›´æ¥æ‰§è¡Œæˆ‘è‡ªå·±ç¼–å†™çš„é™æ€é“¾æ¥çš„ init äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘è¯¥æ€ä¹ˆåšã€‚</p>
<p>æŸ¥çœ‹æ‰‹å†Œå¾—çŸ¥ï¼Œkernel init å‡½æ•°ä¸­ï¼Œä¼šå°è¯•æŒ‰é¡ºåºæ‰§è¡Œä¸€äº›ä¸œè¥¿</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">try_to_run_init_process</span>(<span style="color:#e6db74">&#34;/sbin/init&#34;</span>) <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#f92672">!</span><span style="color:#a6e22e">try_to_run_init_process</span>(<span style="color:#e6db74">&#34;/etc/init&#34;</span>) <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#f92672">!</span><span style="color:#a6e22e">try_to_run_init_process</span>(<span style="color:#e6db74">&#34;/bin/init&#34;</span>) <span style="color:#f92672">||</span>
</span></span><span style="display:flex;"><span>	    <span style="color:#f92672">!</span><span style="color:#a6e22e">try_to_run_init_process</span>(<span style="color:#e6db74">&#34;/bin/sh&#34;</span>))
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span></code></pre></div><p>è¿™ä¾¿æ˜¯å¯åŠ¨çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œå¦‚æœä¸€ä¸ªéƒ½æ²¡æ‰¾åˆ°ï¼Œé‚£ä¹ˆå°±ä¼š kernel panicã€‚</p>
<p>QEMU ä¸­å¯ä»¥ç”¨å‚æ•°æŒ‡å®šå¯åŠ¨çš„ç³»ç»Ÿé•œåƒï¼Œä»è€Œä¸éœ€è¦è€ƒè™‘ bootloader çš„äº‹æƒ…ï¼Œå› æ­¤å…ˆåœ¨ x86 å¹³å°åšè¿™ä¸ªäº‹æƒ…ã€‚ä¸ºæ­¤æˆ‘ä»¬éœ€è¦å‡†å¤‡ å†…æ ¸é•œåƒä¸æ ¹æ–‡ä»¶ç³»ç»Ÿé‡Œçš„ä¸œè¥¿ã€‚</p>
<p>å†…æ ¸é•œåƒå¯æ‹¿ä¸€ä¸ªç°æˆçš„æ¥ç”¨ <code>/boot/vmlinuz</code> ï¼Œ</p>
<p>æŒ‰ç…§ linux çº¦å®šçš„æ–¹å¼ï¼ŒæŠŠæˆ‘ä»¬è‡ªå·±çš„å¯æ‰§è¡Œæ–‡ä»¶æ”¾åˆ° bin é‡Œ</p>
<p>å‡†å¤‡å¥½äº†æ‰€æœ‰ä¸œè¥¿ï¼ŒæŠŠè¿™äº›ä¸œè¥¿æ‰“åŒ…èµ·æ¥</p>
<pre tabindex="0"><code>cd rootfs
find . -print0 | cpio --null -ov --format=newc | gzip -9 &gt; ../rootfs.cpio.gz
</code></pre><p>åœ¨ QEMU é‡Œå¯åŠ¨ï¼ŒæŒ‡å®šä¸€äº›å¯åŠ¨å‚æ•°</p>
<pre tabindex="0"><code>qemu-system-x86_64 \
  -serial mon:stdio \
  -kernel ./vmlinuz \
  -initrd ./rootfs.cpio.gz \
  -machine accel=kvm:tcg \
  -append &#34;console=ttyS0 rdinit=/bin/init&#34;
</code></pre><h2 id="åµŒå…¥å¼-linux">åµŒå…¥å¼ linux</h2>
<p>äº¤å‰ç¼–è¯‘ busyboxï¼Œå‡†å¤‡å¥½ rootfsï¼Œé€šè¿‡ nfs æ–¹å¼ç½‘ç»œæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿã€‚ä½¿ç”¨èµ·æ¥ç”šè‡³æ¯” QEMU è¿˜è¦å¥½ç”¨ã€‚</p>
<p>kernel ç›´æ¥æ‰¾åˆ°äº† /bin/initï¼Œå¹¶è¿è¡Œèµ·æ¥ã€‚</p>

          <hr />
        </div>
        <div>
          

  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
    this.page.url = "https:\/\/xym.work\/blog\/%E6%9E%84%E5%BB%BA%E6%9C%80%E5%B0%8F-linux-%E7%B3%BB%E7%BB%9F\/";
    this.page.identifier = ""; 
    };
    (function () { 
      var d = document, s = d.createElement('script');
      s.src = 'https://mydisquscode.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>


        </div>
      </div>
    </div>

    <div class="footer flex items-center justify-center">
  <div class="py-4">
  <footer>
    <p class="whitespace-nowrap">Â© 2024. <a href="https://github.com/xym-ee" target="_blank">xym-ee
    </a> all rights reserved.</p>
  </footer>
</div>
</div>
  </div>
  

  </div>
  
        <script type="text/javascript" src="/js/navbar.min.a2e7a3db4f1b58e7616cfd31a099340a207d5b99d96df87f525f17c604e184c1.js" integrity="sha256-ouej208bWOdhbP0xoJk0CiB9W5nZbfh/Ul8XxgThhME=" crossorigin="anonymous"></script>

  <script id="dsq-count-scr" src="//nayanseth.disqus.com/count.js" async></script>
  
</body>

</html>